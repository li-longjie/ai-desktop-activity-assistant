# AI 桌面活动助手 - 桌面版使用说明

## 概述

AI 桌面活动助手现已升级为现代化的桌面应用程序，采用 PySide6 构建，具有科技感的毛玻璃效果界面和系统托盘支持。

## 主要特性

### 🎨 现代化界面
- 科技感渐变背景
- 毛玻璃效果组件
- 现代化按钮和表格样式
- 响应式布局设计
- 可调整窗口大小

### 🔧 功能模块
1. **💬 AI 对话** - 自然语言查询活动记录
2. **📊 使用统计** - 应用使用时长统计和分析
3. **📋 活动记录** - 查看和管理屏幕活动记录
4. **⚙️ 设置** - 保存路径设置、API配置和系统管理

### 🔄 系统托盘支持
- 最小化到系统托盘
- 托盘菜单快速操作
- 启动通知和状态提示
- 双击托盘图标恢复窗口

### 🚀 智能屏幕录制
- **默认自动开启** - 安装后立即开始智能记录
- **可控制开关** - 在设置中手动启动/停止
- **自动数据刷新** - 新记录实时更新到界面

## 安装与运行

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动应用

#### 方法一：使用Windows批处理文件（推荐）
双击 `启动AI助手.bat` 文件

#### 方法二：使用Python启动脚本
```bash
python start_modern_gui.py
```

#### 方法三：直接运行主程序
```bash
python modern_gui.py
```

## 功能详解

### AI 助手对话
- 支持中文自然语言查询
- 智能时间解析（如"昨天"、"过去2小时"等）
- 实时对话历史记录
- 异步查询，不阻塞界面

**示例查询：**
- "昨天我在VSCode上工作了多长时间？"
- "今天上午我浏览了哪些网站？"
- "过去一周我主要使用了哪些应用？"

### 活动记录查看
- 表格形式展示活动记录
- 支持排序和筛选
- 显示时间、应用、窗口标题、OCR文本等
- 实时刷新按钮
- 自动更新新记录

### 应用使用统计
- 多时间段统计（今天、昨天、本周、本月）
- 应用使用时长和比例分析
- 直观的卡片式展示
- 自动排序（按使用时长）
- 应用图标和进度条可视化

### 设置页面
- **保存路径设置**：数据库保存位置、截图保存路径配置
- **API设置**：硅基流动API密钥配置和连接测试
- **屏幕录制**：启动/停止录制服务，状态显示
- **数据管理**：重新加载、清空数据库
- **界面刷新**：自动刷新间隔设置

## 配置文件

应用会自动创建 `gui_settings.json` 配置文件，包含：

### 窗口设置
- 窗口大小和位置
- 最大化状态

### UI设置
- 主题配置
- 字体大小
- 自动刷新设置
- 系统托盘配置

### 路径设置
- 数据目录路径
- 截图保存目录
- 数据库保存位置

### API设置
- 硅基流动API密钥
- 默认模型选择
- API连接参数

### 捕获设置
- **自动启动**：默认开启屏幕录制
- 捕获间隔
- OCR和URL检测开关

### 通知设置
- 启用通知
- 启动消息
- 错误通知

## 快捷键和操作

- **双击系统托盘图标**：恢复窗口
- **关闭窗口**：最小化到托盘（可配置）
- **Enter键**：在对话框中发送消息
- **Ctrl+C**：复制选中的文本（在记录表格中）
- **窗口调整**：支持拖拽调整窗口大小

## 技术特性

### 异步处理
- 所有AI查询都在后台线程中进行
- 界面始终保持响应
- 实时显示查询状态

### 配置管理
- 自动保存用户偏好
- 窗口位置和大小记忆
- 支持热重载配置

### 错误处理
- 完善的异常捕获和显示
- 用户友好的错误消息
- 托盘通知错误状态

### 自动刷新
- 默认30秒自动刷新新数据
- 可在设置中调整间隔（10-300秒）
- 智能刷新当前显示页面

## 常见问题

### Q: 应用启动失败？
A: 检查是否安装了所有依赖，特别是 PySide6 和 qtawesome

### Q: 系统托盘图标不显示？
A: 确保系统支持托盘图标，可在设置中禁用托盘功能

### Q: AI查询无响应？
A: 检查设置中的硅基流动API密钥配置是否正确

### Q: 记录表格为空？
A: 确保屏幕录制在设置中已启动，或点击"重新加载数据"

### Q: 屏幕录制不工作？
A: 在设置页面检查录制状态，确保显示"🔴 屏幕录制已激活"

### Q: OCR识别效果不好？
A: 确保Tesseract正确安装并包含中文语言包

## 界面改进记录

### 最新优化
- ✅ **文字优化**："路径设置"→"保存路径设置"，"数据目录"→"数据库保存位置"
- ✅ **按钮优化**："选择"→"浏览"按钮
- ✅ **图标修复**：API设置和测试连接图标颜色修正
- ✅ **窗口支持**：可调整大小，使用系统标题栏
- ✅ **录制控制**：默认开启，真实控制录制服务

## 开发信息

- **界面框架**：PySide6 (Qt6)
- **图标库**：QtAwesome (FontAwesome)
- **配置管理**：JSON
- **异步处理**：asyncio + QThread
- **OCR引擎**：Tesseract-OCR（本地处理）
- **AI模型**：硅基流动API集成

## 更新计划

- [ ] 添加深色主题支持
- [ ] 实现数据导出功能
- [ ] 增加快捷键配置
- [ ] 添加插件系统
- [ ] 优化内存使用
- [ ] 添加数据可视化图表

---

**享受更高效的桌面活动管理体验！** 🚀 